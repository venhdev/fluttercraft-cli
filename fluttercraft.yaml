# fluttercraft.yaml - Build Configuration
# Generated by fluttercraft CLI

# ══════════════════════════════════════════════════════════════════════════════
# BASE BUILD CONFIGURATION (anchor for inheritance)
# ══════════════════════════════════════════════════════════════════════════════
build_defaults: &build_defaults
  # App identifier (from pubspec or override here)
  app_name: fluttercraft

  # Semantic version (x.y.z)
  name: 0.1.1
  # Build number (integer)
  number: 1
  # Build type: aab | apk | ipa | app
  type: aab
  # Main entry point
  target: lib/main.dart

  # ────────────────────────────────────────────────────────────────────────────
  # Dart Define - Always applied when should_add_dart_define = true
  # ────────────────────────────────────────────────────────────────────────────
  global_dart_define:
    APP_NAME: fluttercraft

  # Flavor/build-specific dart defines (merged with global)
  dart_define: {}

  # ────────────────────────────────────────────────────────────────────────────
  # Build Flags
  # ────────────────────────────────────────────────────────────────────────────
  flags:
    # Use dart-define (combines global_dart_define + dart_define)
    should_add_dart_define: false
    # Run flutter clean before build
    should_clean: false
    # Run build_runner before build
    should_build_runner: false

# ══════════════════════════════════════════════════════════════════════════════
# ACTIVE BUILD CONFIGURATION
# ══════════════════════════════════════════════════════════════════════════════
build:
  <<: *build_defaults

  # Active flavor: null | dev | staging | prod
  # If set, overrides from flavors section are applied
  flavor: null

# ══════════════════════════════════════════════════════════════════════════════
# FLAVOR OVERRIDES
# Each flavor can override: name, number, flags, dart_define
# ══════════════════════════════════════════════════════════════════════════════
flavors:
  dev:
    flags:
      should_add_dart_define: true
    dart_define:
      IS_DEV: true
      LOG_LEVEL: debug

  staging:
    name: 0.1.1-rc
    flags:
      should_add_dart_define: true
      should_clean: true
    dart_define:
      IS_STAGING: true

  prod:
    flags:
      should_add_dart_define: true
      should_clean: true
      should_build_runner: true
    dart_define:
      IS_PROD: true

# ══════════════════════════════════════════════════════════════════════════════
# ENVIRONMENT TOOLS (global only - not overridable by flavors)
# ══════════════════════════════════════════════════════════════════════════════
environments:
  # FVM integration
  fvm:
    enabled: true
    # Pinned Flutter version (auto-detected from .fvmrc if null)
    version: 3.35.3

  # Shorebird integration
  shorebird:
    enabled: true
    # App ID (auto-detected from shorebird.yaml)
    app_id: 12345678-f1f1-f2f2-f3f3-f4f4f4f4f4f4
    # @read-only [build:type] - Artifact type derived from build.type
    artifact: null
    # Skip confirmation prompts (maps to --no-confirm)
    no_confirm: true

  # Bundletool (AAB → APK conversion)
  bundletool:
    # Path to bundletool.jar (optional)
    path: null
    # Path to key.properties file
    keystore: android/key.properties

  # Disable colors in console output
  no_color: false

# ══════════════════════════════════════════════════════════════════════════════
# OUTPUT PATHS
# ══════════════════════════════════════════════════════════════════════════════
paths:
  # Output directory for build artifacts
  # Note: if flavor is set, output becomes dist/<flavor>/
  output: dist

# ══════════════════════════════════════════════════════════════════════════════
# CUSTOM COMMAND ALIASES
# ══════════════════════════════════════════════════════════════════════════════
alias:
  gen-icon:
    cmds:
      - fvm flutter pub get
      - fvm flutter pub run flutter_launcher_icons
  brn:
    cmds:
      - fvm flutter pub get
      - fvm flutter packages pub run build_runner build --delete-conflicting-outputs
